### Configuring Dynamic Analyzer with MobSF Android 4.4.2 x86 VirtualBox VM

Dynamic Anlayzer is available only for Android binaries (APK) and works only if your computer has at least 4GB of RAM and Full Virtualization support. 

**NOTE**: If you are configuring MobSF VM in VirtualBox for Dynamic Analysis, you must have configured MobSF in the host OS and not inside any VM.

To Configure Dynamic Analyzer we need 4 things.
* VM UUID
* Snapshot UUID
* Host/Proxy IP
* VM/Device IP
 
#### Steps to Follow

* Open VirtualBox, Go to **File -> Import Appliance** and select the MobSF_VM_X.X.ova file.
  
  ![Importing MobSF VM ova file](https://cloud.githubusercontent.com/assets/4301109/9768972/cbdd115e-5744-11e5-88dc-bf280df3a963.png)

* Proceed with the import process. Do not alter anything.
* Once the OVA is Imported Successfully, you will see a new entry in VirtualBox named MobSF_VM_X.X
* Right Click MobSF VM and Choose Settings, Go to Network tab. Here we need to configure two Network Adapters.
  
  * **Adapter** 1 should be enabled and attached to **Host-only Adapter**. Remember the name of the adapter. We need the name to Identify the Host/Proxy IP.
    
    ![Adapter 1](https://cloud.githubusercontent.com/assets/4301109/9769043/2852d5b8-5745-11e5-9da4-0d76c18ecc3b.png)
  
  * **Adapter 2** should be enabled and attached to **NAT**
    
    ![Adapter 2](https://cloud.githubusercontent.com/assets/4301109/9769162/14556a70-5746-11e5-8d76-ce8d6d200167.png)

* Save the settings and Start MobSF VM. While the VM is Booting up. Note down the **VM IP**.
  
  ![VM IP](https://cloud.githubusercontent.com/assets/4301109/9769219/794771da-5746-11e5-9d81-5549422aac71.png)
* Once the VM Boots up, It will present a Lock Screen. The password for the Lock Screen is `1234`
  
  ![MobSF VM](https://cloud.githubusercontent.com/assets/4301109/9769278/c35e0f90-5746-11e5-9d07-75c1c63e8cdb.png)
  
  **NOTE**: If the VM does not boot up properly then you cannot perform Dynamic Analysis with MobSF VM.
* **Getting the Host/Proxy IP**
  * **Windows** : Issue the command `ipconfig` in command prompt and note down the IP corresponding to the name of the Host-only Adapter.

    ![ipconfig example windows](https://cloud.githubusercontent.com/assets/4301109/9769557/8fdcf3d2-5748-11e5-905e-927159ea525b.png)

  * **Unix** : Issue the command `ifconfig` in terminal and note down the IP corresponding to the name of the Host-only Adapter.

    ![ifconfig example in mac](https://cloud.githubusercontent.com/assets/4301109/9769553/88bb329e-5748-11e5-9e91-3d14db839771.png)
    
   **NOTE**: The VirtualBox Host-Only Adapter IP and MobSF VM IP should be in the same network range. If your MobSF VM IP and Adapter IP are in different network range, modify the Adapter IP to be in the same network range as that of MobSF VM IP. 

   See: [What to do when MobSF VM and VirtualBox Host Only Adapter are not in the same network range](https://github.com/MobSF/Mobile-Security-Framework-MobSF/wiki/6.-What-to-do-when-MobSF-VM-and-VirtualBox-Host-Only-Adapter-are-not-in-the-same-network-range)
* Go to Wi-Fi Settings in **MobSF VM** and set the Proxy IP as the Host/Proxy IP which you have obtained from the previous step and port no as `1337`.

  ![Proxy Settings in VM](https://cloud.githubusercontent.com/assets/4301109/9769738/92961788-5749-11e5-98ac-26488ca46516.png)

* Save the settings and Navigate to the Home Screen of  **MobSF VM**. Wait for 30 seconds and save a snapshot of the **MobSF VM** in VirtualBox

  ![Saving MobSF VM Snapshot](https://cloud.githubusercontent.com/assets/4301109/9769841/26555556-574a-11e5-9de2-c7eb8b0f30bf.png)

* Once the Snapshot is saved, right click **MobSF VM** and select `Show in Explorer` or `Show in Finder`.
 
 ![Show VM Files](https://cloud.githubusercontent.com/assets/4301109/9769901/83c30b3e-574a-11e5-8f90-6ac02732429a.png)

* Open the File **MobSF_VM_X.X.vbox** in any Text Editor and note down the VM UUID and Snapshot UUID

 ![Getting VM UUID and Snapshot UUID](https://cloud.githubusercontent.com/assets/4301109/9769959/e9d9bb0c-574a-11e5-8005-730306445be9.png) 
  
  Here the value of `uuid` is the **VM UUID** and `currentSnapshot` is the **Snapshot UUID**.

* Now we have all the things needed to configure the Dynamic Analyzer (Host/Proxy IP, VM IP, VM UUID and Snapshot UUID)

* Go to `MobSF/settings.py` and set the appropriate values as

  * UUID = VM UUID
  * SUUID = Snapshot UUID
  * VM_IP = VM IP
  * PROXY_IP = Host/Proxy IP 
* In `MobSF/settings.py`, set `ANDROID_DYNAMIC_ANALYZER = "MobSF_VM"` (default)
* This will configure MobSF to use Android VirtualBox VM for Dynamic Analysis.