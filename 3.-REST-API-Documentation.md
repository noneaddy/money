**MobSF REST APIs**

1. `api/v1/upload` - [Upload a File](#upload-file-api)
2. `api/v1/scan` - [Scan a File](#scan-file-api)
3. `api/v1/delete_scan` - [Delete a Scan](#delete-scan-api)
4. `api/v1/download_pdf` - [Download PDF Report](#generate-pdf-report-api)
5. `api/v1/report_json` - [Generate JSON Report](#generate-json-report-api)
6. `api/v1/view_source` - [View Source Files](#view-source-files-api)


**Upload File API**
----
API to upload a file. Supported file types are apk, zip, ipa and appx.

* **URL:** `/api/v1/upload`
* **Method:** `POST`
* **Header:** `Authorization:<api_key>`

*  **Data Params**

Param Name | Param Value | Required
---------- | ----------- | --------
file | `multipart/form-data` | Yes

* **Success Response:**

  * **Code:** `200` <br />
    **Content-Type:**  `application/json; charset=utf-8` <br />
    **Content:** `{"file_name": "diva-beta.apk", "hash": "82ab8b2193b3cfb1c737e3a786be363a", "scan_type": "apk"}`
 
* **Error Response:**

  * **Code:**  `500 Internal Server Error` or  `405 Method Not Allowed` or `422 Unprocessable Entity` <br />
    **Content-Type:**  `application/json; charset=utf-8` <br />
    **Content:** `{"error": <error message> }`

  OR

  * **Code:** `401 Unauthorized` <br />
    **Content-Type:**  `application/json; charset=utf-8` <br />
    **Content:** `{"error": "You are unauthorized to make this request." }`

* **Sample Call:**

  ```
  curl -F 'file=@/Users/ajin/Desktop/diva-beta.apk' http://localhost:8000/api/v1/upload -H "Authorization:563d64fc5054d3b239ac0419f1d6b2378465f5c80e1778c283eb1e3265bdd7ae"
  ```
<hr>

**Scan File API**
----
API to scan a file that is already uploaded.

* **URL:** `/api/v1/scan`
* **Method:** `POST`
* **Header:** `Authorization:<api_key>`
  
*  **Data Params**


Param Name | Param Value | Required
---------- | ----------- | --------
scan_type | apk, zip, ipa, or appx | Yes
file_name | Name of the app with extension | Yes
hash | hash of the scan | Yes
re_scan | 0 or 1, default is 0 | No


* **Success Response:**

  * **Code:** `200` <br />
    **Content-Type:**  `application/json; charset=utf-8` <br />
    **Content:** 
   ```
   {"act_count": "17", "api": {"Loading Native Code (Shared Library) ": {"path": 
   ["jakhar/aseem/diva/DivaJni.java"]}, "Local File I/O Operations": {"path": 
   ["jakhar/aseem/diva/InsecureDataStorage2Activity.java", "jakhar/aseem/diva/SQLInjectionActivity.java"]}, 
   "Starting Activity": {"path": ["jakhar/aseem/diva/AccessControl1Activity.java", 
   "jakhar/aseem/diva/AccessControl2Activity.java", "jakhar/aseem/diva/AccessControl3Activity.java", 
   "jakhar/aseem/diva/MainActivity.java"]}, "Query Database of SMS, Contacts etc.": {"path": 
   ["jakhar/aseem/diva/AccessControl3NotesActivity.java", "jakhar/aseem/diva/NotesProvider.java"]}
   SNIPPED
   ```
 
* **Error Response:**

  * **Code:**  `500 Internal Server Error` or  `405 Method Not Allowed` or `422 Unprocessable Entity` <br />
    **Content-Type:**  `application/json; charset=utf-8` <br />
    **Content:** `{"error": <error message> }`

  OR

  * **Code:** `401 Unauthorized` <br />
    **Content-Type:**  `application/json; charset=utf-8` <br />
    **Content:** `{"error": "You are unauthorized to make this request." }`

* **Sample Call:**

  ```
  curl -X POST --url http://localhost:8000/api/v1/scan --data "scan_type=apk&file_name=diva-beta.apk&hash=82ab8b2193b3cfb1c737e3a786be363a" -H "Authorization:563d64fc5054d3b239ac0419f1d6b2378465f5c80e1778c283eb1e3265bdd7ae"
  ```

<hr>

**Delete Scan API**
----
API to delete scan results.

* **URL:** `/api/v1/delete_scan`
* **Method:** `POST`
* **Header:** `Authorization:<api_key>`
  
*  **Data Params**

Param Name | Param Value | Required
---------- | ----------- | --------
hash | hash of the scan | Yes

* **Success Response:**

  * **Code:** `200` <br />
    **Content-Type:**  `application/json; charset=utf-8` <br />
    **Content:** `{"deleted": "yes"}` or `{"deleted": "no"}`

* **Error Response:**

  * **Code:**  `500 Internal Server Error` or  `405 Method Not Allowed` or `422 Unprocessable Entity` <br />
    **Content-Type:**  `application/json; charset=utf-8` <br />
    **Content:** `{"error": <error message> }`

  OR

  * **Code:** `401 Unauthorized` <br />
    **Content-Type:**  `application/json; charset=utf-8` <br />
    **Content:** `{"error": "You are unauthorized to make this request." }`

* **Sample Call:**

  ```
  curl -X POST --url http://localhost:8000/api/v1/delete_scan --data "hash=82ab8b2193b3cfb1c737e3a786be363a" -H "Authorization:563d64fc5054d3b239ac0419f1d6b2378465f5c80e1778c283eb1e3265bdd7ae"
  ```
<hr>

**Generate PDF Report API**
----
API to generate PDF Report

* **URL:** `/api/v1/download_pdf`
* **Method:** `POST`
* **Header:** `Authorization:<api_key>`

*  **Data Params**

Param Name | Param Value | Required
---------- | ----------- | --------
hash | hash of the scan | Yes
scan_type| apk, andzip, ioszip, ipa, or appx | Yes

* **Success Response:**

  * **Code:** `200` <br />
    **Content-Type:**  `application/pdf` <br />
    **Content:** `PDF Contents`

* **Error Response:**

  * **Code:**  `500 Internal Server Error` or  `405 Method Not Allowed` or `422 Unprocessable Entity` <br />
    **Content-Type:**  `application/json; charset=utf-8` <br />
    **Content:** `{"error": <error message> }`

  OR

  * **Code:** `401 Unauthorized` <br />
    **Content-Type:**  `application/json; charset=utf-8` <br />
    **Content:** `{"error": "You are unauthorized to make this request." }`

* **Sample Call:**

  ```
  curl -X POST --url http://localhost:8000/api/v1/download_pdf --data "hash=82ab8b2193b3cfb1c737e3a786be363a&scan_type=apk" -H "Authorization:563d64fc5054d3b239ac0419f1d6b2378465f5c80e1778c283eb1e3265bdd7ae"
  ```
<hr>

**Generate JSON Report API**
----
API to generate JSON Report

* **URL:** `/api/v1/report_json`
* **Method:** `POST`
* **Header:** `Authorization:<api_key>`

*  **Data Params**

Param Name | Param Value | Required
---------- | ----------- | --------
hash | hash of the scan | Yes
scan_type| apk, andzip, ioszip, ipa, or appx | Yes

* **Success Response:**

  * **Code:** `200` <br />
    **Content-Type:**  `application/json; charset=utf-8` <br />
    **Content:** `JSON Contents`

* **Error Response:**

  * **Code:**  `500 Internal Server Error` or  `405 Method Not Allowed` or `422 Unprocessable Entity` <br />
    **Content-Type:**  `application/json; charset=utf-8` <br />
    **Content:** `{"error": <error message> }`

  OR

  * **Code:** `401 Unauthorized` <br />
    **Content-Type:**  `application/json; charset=utf-8` <br />
    **Content:** `{"error": "You are unauthorized to make this request." }`

* **Sample Call:**

  ```
  curl -X POST --url http://localhost:8000/api/v1/report_json --data "hash=82ab8b2193b3cfb1c737e3a786be363a&scan_type=apk" -H "Authorization:563d64fc5054d3b239ac0419f1d6b2378465f5c80e1778c283eb1e3265bdd7ae"
  ```

<hr>

**View Source Android Files API**
----
API to view source of Android files

* **URL:** `/api/v1/viewsource/android`
* **Method:** `POST`
* **Header:** `Authorization:<api_key>`

*  **Data Params**

Param Name | Param Value | Required
---------- | ----------- | --------
md5 | md5 of the scan file | Yes
file | file path | Yes
type | `eclipse/studio/apk` | Yes


* **Success Response:**

  * **Code:** `200` <br />
    **Content-Type:**  `application/json; charset=utf-8` <br />
    **Content:** `JSON Contents`

* **Error Response:**

  * **Code:**  `500 Internal Server Error` or  `405 Method Not Allowed` or `422 Unprocessable Entity` <br />
    **Content-Type:**  `application/json; charset=utf-8` <br />
    **Content:** `{"error": <error message> }`

  OR

  * **Code:** `401 Unauthorized` <br />
    **Content-Type:**  `application/json; charset=utf-8` <br />
    **Content:** `{"error": "You are unauthorized to make this request." }`

* **Sample Call:**

  ```
  curl -X POST --url http://localhost:8000/api/v1/viewsource/android --data "md5=82ab8b2193b3cfb1c737e3a786be363a&type=apk&file=uk/co/senab/photoview/log/LoggerDefault.java" -H "Authorization:563d64fc5054d3b239ac0419f1d6b2378465f5c80e1778c283eb1e3265bdd7ae"
  ```

<hr>

**View Source Files API**
----
API to view source files

* **URL:** `/api/v1/view_source`
* **Method:** `POST`
* **Header:** `Authorization:<api_key>`

*  **Data Params**

Param Name | Param Value | Required
---------- | ----------- | --------
hash | hash of the scan | Yes
file | relative file path | Yes
mode |  `ipa/ios` | Yes
ext |  `m/xml/db/txt`| Yes

* **Success Response:**

  * **Code:** `200` <br />
    **Content-Type:**  `application/json; charset=utf-8` <br />
    **Content:** `JSON Contents`

* **Error Response:**

  * **Code:**  `500 Internal Server Error` or  `405 Method Not Allowed` or `422 Unprocessable Entity` <br />
    **Content-Type:**  `application/json; charset=utf-8` <br />
    **Content:** `{"error": <error message> }`

  OR

  * **Code:** `401 Unauthorized` <br />
    **Content-Type:**  `application/json; charset=utf-8` <br />
    **Content:** `{"error": "You are unauthorized to make this request." }`

* **Sample Call:**

  ```
  curl -X POST//localhost:8000/api/v1/view_source --data "hash=6c23c2970551be15f32bbab0b5db0c71&mode=ipa&ext=xml&file=helloworld.app/ResourceRules.plist" -H "Authorization:7e2ddf418b291d2e070496524d1b8599c31637f84055c5db632f49f1a613f5f5"
  ```

<hr>

You can pre-configure the API key by setting the environment variable `MOBSF_API_KEY`.

Example API Calls: [Python](https://gist.github.com/ajinabraham/0f5de3b0c7b7d3665e54740b9f536d81), [Ruby](https://github.com/MobSF/mobsf-ci/blob/master/scan/scan.rb), [AJAX](https://gist.github.com/ajinabraham/bf2945741346c2fcdcd1b2e3df8baab0)